# GeoRisk Raster Pipeline

Python-based raster processing pipeline for satellite imagery analysis and land-surface change detection.

## Features

- Sentinel-2 imagery discovery via Microsoft Planetary Computer STAC
- NDVI calculation from red and near-infrared bands
- Change detection between temporal image pairs
- Risk scoring based on proximity to infrastructure assets
- MinIO S3-compatible storage integration

## Installation

```bash
# Create virtual environment
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# or: .venv\Scripts\activate  # Windows

# Install package in development mode
pip install -e ".[dev]"
```

## Configuration

Configuration is loaded from:
1. Environment variables (highest priority)
2. `.env` file in the pipeline directory
3. `config/` YAML files

Required environment variables (generated by the setup script into `src/pipeline/.env`):
```bash
# MinIO connection
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=<generated by setup script>
MINIO_SECRET_KEY=<generated by setup script>
```

## CLI Usage

```bash
# Search for available Sentinel-2 imagery
georisk search --aoi-id paradise-ca --date-range 2018-01-01/2018-12-31

# Process imagery and detect changes
georisk process --aoi-id paradise-ca --before 2018-10-01 --after 2018-12-01

# Fetch imagery only (no processing)
georisk fetch --aoi-id paradise-ca --date 2018-11-08

# View pipeline status
georisk status --run-id <run-id>
```

## Project Structure

```
georisk/
├── __init__.py
├── config.py          # Configuration management
├── stac/              # STAC catalog client
├── raster/            # Raster processing (NDVI, change detection)
├── risk/              # Risk scoring
├── storage/           # MinIO integration
├── db/                # API client
└── cli.py             # CLI entry point
```
